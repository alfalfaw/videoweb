(function(e){function t(t){for(var a,s,o=t[0],c=t[1],u=t[2],h=0,d=[];h<o.length;h++)s=o[h],Object.prototype.hasOwnProperty.call(n,s)&&n[s]&&d.push(n[s][0]),n[s]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(e[a]=c[a]);l&&l(t);while(d.length)d.shift()();return i.push.apply(i,u||[]),r()}function r(){for(var e,t=0;t<i.length;t++){for(var r=i[t],a=!0,o=1;o<r.length;o++){var c=r[o];0!==n[c]&&(a=!1)}a&&(i.splice(t--,1),e=s(s.s=r[0]))}return e}var a={},n={app:0},i=[];function s(t){if(a[t])return a[t].exports;var r=a[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,s),r.l=!0,r.exports}s.m=e,s.c=a,s.d=function(e,t,r){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(s.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)s.d(r,a,function(t){return e[t]}.bind(null,a));return r},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=t,o=o.slice();for(var u=0;u<o.length;u++)t(o[u]);var l=c;i.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("90a1")},"0e5d":function(e,t,r){"use strict";var a=r("a6c4"),n=r.n(a);n.a},1:function(e,t){},"1dbb":function(e,t,r){"use strict";var a=r("fc11"),n=r.n(a);n.a},"1de9":function(e,t,r){},2395:function(e,t,r){},"2c81":function(e,t,r){},"301c":function(e,t,r){e.exports=r.p+"img/banner.9dc22001.jpg"},"3b67":function(e,t,r){"use strict";var a=r("9c52"),n=r.n(a);n.a},6389:function(e,t){e.exports=VueRouter},"7c55":function(e,t,r){"use strict";var a=r("2395"),n=r.n(a);n.a},"8a22":function(e,t,r){},"8bbf":function(e,t){e.exports=Vue},"90a1":function(e,t,r){"use strict";r.r(t);var a={};r.r(a),r.d(a,"formatDate",(function(){return Be})),r.d(a,"formatTime",(function(){return Je})),r.d(a,"breakword",(function(){return Le}));r("4de4"),r("4160"),r("b64b"),r("d3b7"),r("159b"),r("e260"),r("e6cf"),r("cca6"),r("a79d");var n=r("8bbf"),i=r.n(n),s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"app"}},[r("router-view",{key:e.$route.path})],1)},o=[],c=(r("7c55"),r("2877")),u={},l=Object(c["a"])(u,s,o,!1,null,null,null),h=l.exports,d=r("6389"),p=r.n(d),v=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-app",{attrs:{id:"inspire"}},[r("v-navigation-drawer",{attrs:{app:"",clipped:"",color:"#202020"},model:{value:e.drawer,callback:function(t){e.drawer=t},expression:"drawer"}},[r("v-list",{attrs:{dense:""}},[e._l(e.items,(function(t){return r("v-list-item",{key:t.text,attrs:{to:t.link}},[r("v-list-item-action",[r("v-icon",{attrs:{color:"white darken-1"}},[e._v(e._s(t.icon))])],1),r("v-list-item-content",[r("v-list-item-title",{staticClass:"white--text text--lighten-1"},[e._v(e._s(t.text))])],1)],1)})),e.isLogin?r("v-list-item",{on:{click:e.logout}},[r("v-list-item-action",[r("v-icon",{attrs:{color:"white light-1"}},[e._v("lock")])],1),r("v-list-item-title",{staticClass:"white--text text--lighten-1"},[e._v("注销")])],1):r("v-list-item",{on:{click:function(t){e.drawer=!e.drawer,e.sheet=!e.sheet}}},[r("v-list-item-action",[r("v-icon",{attrs:{color:"white light-1"}},[e._v("lock")])],1),r("v-list-item-title",{staticClass:"white--text text--lighten-1"},[e._v("登陆/注册")])],1),r("v-list-item",{directives:[{name:"show",rawName:"v-show",value:e.isAdmin,expression:"isAdmin"}],attrs:{to:{name:"Login"}}},[r("v-list-item-action",[r("v-icon",{attrs:{color:"white light-1"}},[e._v("widgets")])],1),r("v-list-item-title",{staticClass:"white--text text--lighten-1"},[e._v("后台")])],1)],2)],1),r("v-app-bar",{attrs:{app:"","clipped-left":"",dense:""}},[r("v-app-bar-nav-icon",{attrs:{color:"white"},on:{click:function(t){t.stopPropagation(),e.drawer=!e.drawer}}}),r("v-toolbar-title",{staticClass:"mr-12 align-center"},[r("span",{staticClass:"title white--text text--lighten-1"},[e._v("极客视频")])]),r("v-spacer"),r("v-row",{staticStyle:{"max-width":"600px"},attrs:{align:"center"}},[r("div",{staticClass:"search-wrapper"},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.keyword,expression:"keyword"}],attrs:{type:"text",id:"search-input"},domProps:{value:e.keyword},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search()},input:function(t){t.target.composing||(e.keyword=t.target.value)}}}),r("span",{attrs:{id:"serach-btn"}},[r("v-icon",{on:{click:function(t){return e.search()}}},[e._v("search")])],1)])])],1),r("v-content",[r("router-view",{key:e.$route.path}),r("v-row",[r("v-col",{staticClass:"text-center text-white",attrs:{cols:"12"}},[e._v(" "+e._s((new Date).getFullYear())+" — "),r("strong",[e._v("极客视频")])])],1)],1),r("v-bottom-sheet",{attrs:{inset:""},model:{value:e.sheet,callback:function(t){e.sheet=t},expression:"sheet"}},[r("div",{staticClass:"pa-4",attrs:{id:"login-wrapper"}},[r("v-form",{ref:"form",on:{submit:function(t){return t.preventDefault(),e.login(t)}}},[r("v-text-field",{attrs:{label:"用户名"},model:{value:e.loginModel.username,callback:function(t){e.$set(e.loginModel,"username",t)},expression:"loginModel.username"}}),r("v-text-field",{attrs:{label:"密码",type:"password",autocomplete:"new-password"},model:{value:e.loginModel.password,callback:function(t){e.$set(e.loginModel,"password",t)},expression:"loginModel.password"}}),r("v-btn",{staticClass:"mr-4",attrs:{color:"error"},on:{click:e.reset}},[e._v("重置")]),r("v-btn",{staticClass:"mr-4",attrs:{color:"success",type:"submit"}},[e._v("登陆")]),r("v-btn",{staticClass:"mr-4",attrs:{color:"info"},on:{click:e.register}},[e._v("注册")])],1)],1)])],1)},f=[],m=(r("b0c0"),r("25f0"),r("5530")),g=(r("96cf"),r("1da1")),y=r("d4ec"),b=r("bee2"),w=r("99de"),k=r("7e84"),x=r("262e"),_=r("9ab4"),O=r("60a3"),j=function(e){function t(){var e;return Object(y["a"])(this,t),e=Object(w["a"])(this,Object(k["a"])(t).apply(this,arguments)),e.name="Home",e.drawer=null,e.keyword="",e.isAdmin=!1,e.items=[{icon:"home",text:"主页",link:"/"},{icon:"favorite",text:"收藏",link:"/user/favorite"},{icon:"history",text:"历史",link:"/user/history"},{icon:"archive",text:"归档",link:"/archive"},{icon:"folder",text:"文件",link:"/file"}],e.sheet=!1,e.loginModel={username:"",password:""},e.isLogin=!1,e}return Object(x["a"])(t,e),Object(b["a"])(t,[{key:"login",value:function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.$http.post("/auth/login",this.loginModel);case 3:t=e.sent,t.data.access_token&&(window.localStorage.setItem("token","Bearer "+t.data.access_token),this.$message.success("登录成功"),this.sheet=!1,this.isLogin=!0,t.data.admin?(this.isAdmin=!0,window.localStorage.setItem("admin","true")):(this.isAdmin=!1,window.localStorage.setItem("admin","")),this.$router.go(0)),e.next=11;break;case 7:e.prev=7,e.t0=e["catch"](0),this.$message.warning("密码不对哦"),this.loginModel["password"]="";case 11:case"end":return e.stop()}}),e,this,[[0,7]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"logout",value:function(){window.localStorage.token="",window.localStorage.admin="",this.$router.go(0)}},{key:"reset",value:function(){this.loginModel.username="",this.loginModel.password=""}},{key:"search",value:function(){this.$router.push({path:"/",query:{keyword:this.keyword}})}},{key:"register",value:function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(""!=this.loginModel.username&&""!=this.loginModel.password){e.next=3;break}return this.$message.warning("请填写用户必要信息"),e.abrupt("return",!1);case 3:return t=Object(m["a"])({},this.loginModel),t["admin"]=!1,e.next=7,this.$http.post("users/create",t);case 7:if(r=e.sent,r.data.success){e.next=11;break}return this.$message.warning(r.data.msg),e.abrupt("return",!1);case 11:this.$message.success("注册成功，请重新登录"),this.$router.go(0);case 13:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"created",value:function(){this.$route.query.keyword&&(this.keyword=this.$route.query.keyword.toString());var e=window.localStorage.getItem("token");this.isLogin=!!e;var t=window.localStorage.getItem("admin");this.isAdmin="true"===t}}]),t}(O["c"]);Object(_["a"])([Object(O["b"])()],j.prototype,"source",void 0),j=Object(_["a"])([O["a"]],j);var $=j,C=$,M=(r("afa9"),Object(c["a"])(C,v,f,!1,null,"38b7d1cd",null)),q=M.exports,R=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-row",{directives:[{name:"show",rawName:"v-show",value:!this.$route.query.keyword,expression:"!this.$route.query.keyword"}],attrs:{dense:""}},[a("v-col",[a("v-carousel",{attrs:{cycle:"",height:"400","hide-delimiter-background":"","show-arrows-on-hover":""}},e._l(e.items,(function(e,t){return a("v-carousel-item",{key:t,attrs:{src:e.cover,to:"play/"+e._id}})})),1)],1)],1),a("v-row",{directives:[{name:"show",rawName:"v-show",value:this.$route.query.keyword,expression:"this.$route.query.keyword"}],attrs:{dense:""}},[a("v-col",[a("v-parallax",{attrs:{height:"300",dark:"",src:r("301c")}},[a("v-row",{attrs:{align:"center",justify:"center"}},[a("v-col",{staticClass:"text-center",attrs:{cols:"12"}},[a("h1",{staticClass:"display-1 font-weight-thin mb-4"},[e._v("搜索 "+e._s(this.$route.query.keyword))])])],1)],1)],1)],1),a("v-row",{attrs:{dense:""}},e._l(e.cards,(function(t,r){return a("v-col",{key:r,attrs:{cols:"12",lg:4,md:4,sm:6}},[a("v-card",{attrs:{color:"dark"}},[a("router-link",{attrs:{to:"play/"+t._id}},[a("v-img",{staticClass:"white--text align-end",attrs:{src:t.cover,gradient:"to bottom, rgba(0,0,0,.1), rgba(0,0,0,.2)",height:"180px"}})],1),a("v-card-text",{staticClass:"text--primary align-end"},[a("router-link",{attrs:{to:"/play/"+t._id}},[a("p",{staticClass:"font-weight-medium headline white--text"},[e._v(e._s(t.title))])]),a("div",{staticClass:"text--secondary subtitle-2"},[e._v(e._s(e._f("formatTime")(t.createdAt)))])],1),a("v-card-actions",[a("v-btn",{attrs:{icon:""}},[a("v-icon",{style:{color:"favorite"===t.type?"red":"grey"},on:{click:function(r){return e.changeColor(r,t)}}},[e._v("mdi-heart")])],1),a("span",{staticClass:"card-meta"},[e._v(e._s(t.favorite_num))]),a("v-icon",[e._v("mdi-eye")]),a("span",{staticClass:"card-meta ml-2"},[e._v(e._s(t.click_num))])],1)],1)],1)})),1),a("v-row",{attrs:{dense:""}},[a("v-col",[a("div",{directives:[{name:"show",rawName:"v-show",value:e.pages_count>1,expression:"pages_count > 1"}],staticClass:"text-center"},[a("v-pagination",{attrs:{length:e.pages_count,circle:"",value:e.query.page},on:{next:function(t){return e.next()},previous:function(t){return e.prev()},input:function(t){return e.changePage()}},model:{value:e.query.page,callback:function(t){e.$set(e.query,"page",t)},expression:"query.page"}})],1)])],1)],1)},S=[];function F(e){Object.keys(e).forEach((function(t){delete e[t]}))}function E(e,t){Object.keys(t).forEach((function(r){e[r]=t[r]}))}var P=function(e){function t(){var e;return Object(y["a"])(this,t),e=Object(w["a"])(this,Object(k["a"])(t).apply(this,arguments)),e.name="List",e.pages_count=0,e.cards=null,e.items=null,e.query={limit:5,page:1,where:{}},e}return Object(x["a"])(t,e),Object(b["a"])(t,[{key:"created",value:function(){if(this.fetchTop(),this.$route.query.keyword){var e={};e["title"]={$regex:this.$route.query.keyword},E(this.query.where,e)}}},{key:"refresh",value:function(e){if(e.query.keyword){var t={};t["title"]={$regex:e.query.keyword},E(this.query.where,t)}else F(this.query.where);this.fetchVideos()}},{key:"changeColor",value:function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(t,r){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.target,a="favorite"!==r.type,a?(r.type="favorite",r.favorite_num++):(r.type="history",r.favorite_num--),e.next=5,this.$http.get("records/favorite",{params:{video:r._id,like:a}});case 5:case"end":return e.stop()}}),e,this)})));function t(t,r){return e.apply(this,arguments)}return t}()},{key:"fetchTop",value:function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$http.get("videos/top");case 2:t=e.sent,this.items=t.data;case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"fetchVideos",value:function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(){var t,r,a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t={},r="videos",a=window.localStorage.getItem("token"),a&&(r="videos/home"),e.next=6,this.$http.get(r,{params:this.query,headers:t});case 6:n=e.sent,this.pages_count=n.data.total%this.query.limit==0?n.data.total/this.query.limit:Math.floor(n.data.total/this.query.limit)+1,this.cards=n.data.data;case 9:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"next",value:function(){this.fetchVideos()}},{key:"prev",value:function(){this.fetchVideos()}},{key:"changePage",value:function(e){this.fetchVideos()}}]),t}(O["c"]);Object(_["a"])([Object(O["d"])("$route",{immediate:!0,deep:!0})],P.prototype,"refresh",null),P=Object(_["a"])([Object(O["a"])({})],P);var V=P,D=V,A=(r("e572"),Object(c["a"])(D,R,S,!1,null,"03493c2c",null)),N=A.exports,T=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-container",{attrs:{fluid:""}},[r("v-row",[r("v-col",[r("div",{attrs:{id:"player-wrapper"}},[r("video-player",{ref:"videoPlayer",staticClass:"video-player vjs-custom-skin",attrs:{playsinline:!0,options:e.playerOptions}}),r("v-btn",{style:{backgroundColor:!0===this.state?"transparent":"red",color:!0===this.state?"red":"white"},attrs:{absolute:"",dark:"",fab:"",right:"",id:"btn-like"},on:{click:function(t){return e.changeColor(t)}}},[r("v-icon",[e._v("mdi-heart")])],1)],1)])],1)],1)},I=[],z=r("d6d3"),L=r.n(z);r("fda2"),r("451f"),O["c"].use(L.a);var B=function(e){function t(){var e;return Object(y["a"])(this,t),e=Object(w["a"])(this,Object(k["a"])(t).apply(this,arguments)),e.name="Video",e.state=!1,e.playerOptions={playbackRates:[.7,1,1.5,2],autoplay:!1,muted:!1,loop:!1,preload:"auto",language:"zh-CN",aspectRatio:"16:9",fluid:!0,sources:[{type:"video/mp4",src:null}],poster:null,notSupportedMessage:"此视频暂无法播放，请稍后再试",controlBar:{timeDivider:!0,durationDisplay:!0,remainingTimeDisplay:!1,fullscreenToggle:!0}},e}return Object(x["a"])(t,e),Object(b["a"])(t,[{key:"created",value:function(){this.fetch()}},{key:"fetch",value:function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.$http.get("videos/detail/".concat(this.id));case 3:t=e.sent,this.playerOptions.sources[0].src=t.data.url,this.playerOptions.poster=t.data.cover,e.next=10;break;case 8:e.prev=8,e.t0=e["catch"](0);case 10:return e.prev=10,e.next=13,this.$http.get("videos/favorite/".concat(this.id),{params:{id:this.id}});case 13:r=e.sent,this.state=r.data.favorite,e.next=19;break;case 17:e.prev=17,e.t1=e["catch"](10);case 19:return e.prev=19,e.next=22,this.$http.get("records/history",{params:{video:this.id}});case 22:e.next=26;break;case 24:e.prev=24,e.t2=e["catch"](19);case 26:case"end":return e.stop()}}),e,this,[[0,8],[10,17],[19,24]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"changeColor",value:function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.target,this.state=!this.state,e.next=4,this.$http.get("records/favorite",{params:{video:this.id,like:this.state}});case 4:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()}]),t}(O["c"]);Object(_["a"])([Object(O["b"])(String)],B.prototype,"id",void 0),B=Object(_["a"])([Object(O["a"])({})],B);var J=B,H=J,Y=(r("95de"),Object(c["a"])(H,T,I,!1,null,"7afb5420",null)),U=Y.exports,G=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-container",[r("v-row",{attrs:{"no-gutters":""}},[r("v-col",[r("div",{attrs:{id:"upload-form-wrapper"}},[r("v-form",{ref:"form",on:{submit:function(t){return t.preventDefault(),e.submit(t)}}},[r("v-text-field",{attrs:{label:"标题"},model:{value:e.videoModel.title,callback:function(t){e.$set(e.videoModel,"title",t)},expression:"videoModel.title"}}),r("v-text-field",{attrs:{label:"描述"},model:{value:e.videoModel.desc,callback:function(t){e.$set(e.videoModel,"desc",t)},expression:"videoModel.desc"}}),r("v-text-field",{attrs:{label:"作者"},model:{value:e.videoModel.author,callback:function(t){e.$set(e.videoModel,"author",t)},expression:"videoModel.author"}}),r("div",{attrs:{id:"media-wrapper"}},[r("v-file-input",{attrs:{rules:e.rules,accept:"image/png, image/jpeg, image/bmp","prepend-icon":"mdi-camera","show-size":"",label:"封面"},model:{value:e.image,callback:function(t){e.image=t},expression:"image"}}),r("v-file-input",{attrs:{"show-size":"",label:"视频"},model:{value:e.video,callback:function(t){e.video=t},expression:"video"}})],1),r("v-checkbox",{scopedSlots:e._u([{key:"label",fn:function(){return[r("div",[e._v("发布")])]},proxy:!0}]),model:{value:e.videoModel.publish,callback:function(t){e.$set(e.videoModel,"publish",t)},expression:"videoModel.publish"}}),r("v-btn",{staticClass:"mr-4",attrs:{color:"error"},on:{click:e.reset}},[e._v("重置")]),r("v-btn",{staticClass:"mr-4",attrs:{color:"success",type:"submit",disabled:!e.enable}},[e._v("上传")])],1)],1)])],1)],1)},K=[],Q=function(e){function t(){var e;return Object(y["a"])(this,t),e=Object(w["a"])(this,Object(k["a"])(t).apply(this,arguments)),e.name="File",e.videoModel={title:"",desc:"",author:"",cover:null,url:null,publish:!1},e.image=null,e.video=null,e.rules=[function(e){return!e||e.size<2e6||"封面图不超过 2 MB!"}],e.enable=!1,e}return Object(x["a"])(t,e),Object(b["a"])(t,[{key:"mounted",value:function(){}},{key:"created",value:function(){var e=window.localStorage.getItem("admin");"true"==e&&(this.enable=!0)}},{key:"submit",value:function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(){var t,r=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=new FormData,this.video&&t.append("video",this.video),this.image&&t.append("image",this.image),e.prev=3,e.next=6,this.$http.post("uploadmany",t).then((function(e){r.videoModel.cover=e.data.cover,r.videoModel.url=e.data.url})).then(Object(g["a"])(regeneratorRuntime.mark((function e(){var t,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,r.$http.post("videos/create",r.videoModel);case 2:t=e.sent,a=t.data,a.success&&(r.$message.success("上传成功"),r.reset());case 5:case"end":return e.stop()}}),e)}))));case 6:e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](3),this.$message.warning("上传失败");case 11:case"end":return e.stop()}}),e,this,[[3,8]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"reset",value:function(){this.videoModel.title="",this.videoModel.desc="",this.videoModel.author="",this.videoModel.cover="",this.videoModel.url="",this.videoModel.publish=!1,this.video=null,this.image=null}}]),t}(O["c"]);Q=Object(_["a"])([Object(O["a"])({})],Q);var W=Q,X=W,Z=(r("bdeb"),Object(c["a"])(X,G,K,!1,null,"6a862c91",null)),ee=Z.exports,te=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-container",{attrs:{fluid:""}},[r("v-row",[r("v-col",[r("v-row",{attrs:{justify:"space-between"}},[r("v-col",{attrs:{cols:"12"}},[r("v-btn",{staticClass:"ml-4",attrs:{rounded:"",dark:"",id:"btn-today"}},[e._v("今天")])],1)],1),r("v-timeline",{attrs:{dense:"",clipped:""}},e._l(e.archives,(function(t,a){return r("div",{key:a+""},[r("v-timeline-item",{staticClass:"mb-1",attrs:{"fill-dot":"",middle:"",color:e.colors[a%e.colors.length]},scopedSlots:e._u([{key:"icon",fn:function(){return[r("span",{staticClass:"caption white--text text--lighten-1"},[e._v(e._s(t._id.month+"."+t._id.day))])]},proxy:!0}],null,!0)}),e._l(t["videos"],(function(t,n){return r("v-timeline-item",{key:"sub-"+n,attrs:{color:e.colors[a%e.colors.length],small:""}},[r("v-card",{staticClass:"left",attrs:{color:e.colors[a%e.colors.length],dark:"","max-width":"400"}},[r("v-card-title",[r("span",{staticClass:"title font-weight-light"},[e._v(e._s(t.title))])]),r("v-card-text",{staticClass:"headline"},[e._v(e._s(t.title))]),r("v-card-actions",[r("v-list-item",{staticClass:"grow"},[r("v-list-item-content",[r("v-list-item-title")],1),r("v-row",{attrs:{align:"center",justify:"end"}},[r("v-icon",{staticClass:"mr-1"},[e._v("mdi-eye")]),r("span",{staticClass:"subheading mr-2"},[e._v(e._s(t.click_num))]),r("span",{staticClass:"mr-1"}),r("v-icon",{staticClass:"mr-1"},[e._v("mdi-heart")]),r("span",{staticClass:"subheading"},[e._v(e._s(t.favorite_num))])],1)],1)],1)],1)],1)}))],2)})),0),r("v-row",{attrs:{justify:"space-between"}},[r("v-col",{attrs:{cols:"12"}},[r("v-btn",{staticClass:"ml-4",attrs:{rounded:"",dark:"",id:"btn-begin"}},[e._v("开始")])],1)],1)],1)],1)],1)},re=[],ae=function(e){function t(){var e;return Object(y["a"])(this,t),e=Object(w["a"])(this,Object(k["a"])(t).apply(this,arguments)),e.name="Archive",e.archives=null,e.colors=["#313131"],e}return Object(x["a"])(t,e),Object(b["a"])(t,[{key:"mounted",value:function(){}},{key:"created",value:function(){this.fetch()}},{key:"fetch",value:function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$http.get("videos/archive");case 2:t=e.sent,this.archives=t.data;case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}]),t}(O["c"]);ae=Object(_["a"])([Object(O["a"])({})],ae);var ne=ae,ie=ne,se=(r("3b67"),Object(c["a"])(ie,te,re,!1,null,"370a98a3",null)),oe=se.exports,ce=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-row",{attrs:{dense:""}},[a("v-col",[a("v-parallax",{attrs:{height:"300",dark:"",src:r("301c")}},[a("v-row",{attrs:{align:"center",justify:"center"}},[a("v-col",{staticClass:"text-center",attrs:{cols:"12"}},[a("h1",{staticClass:"display-1 font-weight-thin mb-4"},[e._v(" "+e._s("history"===e.resource?"浏览历史":"收藏")+" ")])])],1)],1)],1)],1),a("v-row",{attrs:{dense:""}},e._l(e.cards,(function(t,r){return a("v-col",{key:r,attrs:{cols:"12",lg:4,md:4,sm:6}},[a("v-card",[a("router-link",{attrs:{to:"/play/"+t._id}},[a("v-img",{staticClass:"white--text align-end",attrs:{src:t.cover,gradient:"to bottom, rgba(0,0,0,.1), rgba(0,0,0,.2)",height:"180px"}})],1),a("v-card-text",{staticClass:"text--primary align-end"},[a("router-link",{attrs:{to:"/play/"+t._id}},[a("div",{staticClass:"headline white--text"},[e._v(e._s(t.title))])]),a("div",[e._v(e._s(e._f("formatTime")(t.createdAt)))])],1),a("v-card-actions",[a("v-btn",{attrs:{icon:""}},[a("v-icon",{style:{color:"favorite"===t.type?"red":"grey"},on:{click:function(r){return e.changeColor(r,t)}}},[e._v("mdi-heart")])],1),a("span",{staticClass:"card-meta"},[e._v(e._s(t.favorite_num))]),a("v-icon",[e._v("mdi-eye")]),a("span",{staticClass:"card-meta ml-2"},[e._v(e._s(t.click_num))])],1)],1)],1)})),1),a("v-row",{attrs:{dense:""}},[a("v-col",[a("div",{directives:[{name:"show",rawName:"v-show",value:e.pages_count>1,expression:"pages_count > 1"}],staticClass:"text-center"},[a("v-pagination",{attrs:{length:e.pages_count,circle:"",value:e.page},on:{next:function(t){return e.next()},previous:function(t){return e.prev()},input:function(t){return e.changePage()}},model:{value:e.query.page,callback:function(t){e.$set(e.query,"page",t)},expression:"query.page"}})],1)])],1)],1)},ue=[],le=function(e){function t(){var e;return Object(y["a"])(this,t),e=Object(w["a"])(this,Object(k["a"])(t).apply(this,arguments)),e.pages_count=0,e.cards=null,e.query={limit:5,page:1,where:{}},e}return Object(x["a"])(t,e),Object(b["a"])(t,[{key:"created",value:function(){if(this.$route.query.keyword){var e={};e["title"]={$regex:this.$route.query.keyword},E(this.query.where,e)}}},{key:"refresh",value:function(e){if(e.query.keyword){var t={};t["title"]={$regex:e.query.keyword},E(this.query.where,t)}else F(this.query.where);this.fetchVideos()}},{key:"changeColor",value:function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(t,r){var a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=t.target,n="red"!==a.style.color,n?(a.style.color="red",r.favorite_num++):(a.style.color="grey",r.favorite_num--),e.next=5,this.$http.get("records/favorite",{params:{video:r._id,like:n}});case 5:case"end":return e.stop()}}),e,this)})));function t(t,r){return e.apply(this,arguments)}return t}()},{key:"fetchVideos",value:function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.$http.get("records/collection/".concat(this.resource),{params:this.query});case 3:t=e.sent,this.pages_count=t.data.total%this.query.limit==0?t.data.total/this.query.limit:Math.floor(t.data.total/this.query.limit)+1,this.cards=t.data.data,e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),this.$message.error("请先登录");case 11:case"end":return e.stop()}}),e,this,[[0,8]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"next",value:function(){this.fetchVideos()}},{key:"prev",value:function(){this.fetchVideos()}},{key:"changePage",value:function(e){this.fetchVideos()}}]),t}(O["c"]);Object(_["a"])([Object(O["b"])(String)],le.prototype,"resource",void 0),Object(_["a"])([Object(O["d"])("$route",{immediate:!0,deep:!0})],le.prototype,"refresh",null),le=Object(_["a"])([Object(O["a"])({})],le);var he=le,de=he,pe=(r("0e5d"),Object(c["a"])(de,ce,ue,!1,null,"3d5dc24f",null)),ve=pe.exports,fe=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-container",[r("el-aside",{attrs:{width:"200px"}},[r("el-menu",{staticStyle:{},attrs:{mode:"vertical","default-active":e.$route.path,router:""}},e._l(e.menu.items,(function(t,a){return r("el-menu-item",{key:"item-"+a,attrs:{index:t.path}},[e._v(e._s(t.title))])})),1)],1),r("el-container",[r("el-header",{attrs:{height:"50px"}},[r("h2",{staticClass:"center"},[e._v("极客视频")])]),r("el-main",[r("router-view",{key:e.$route.path})],1)],1)],1)},me=[],ge=function(e){function t(){var e;return Object(y["a"])(this,t),e=Object(w["a"])(this,Object(k["a"])(t).apply(this,arguments)),e.menu={items:[{title:"视频管理",path:"/admin/videos/list"},{title:"用户管理",path:"/admin/users/list"},{title:"记录管理",path:"/admin/records/list"}]},e}return Object(x["a"])(t,e),t}(O["c"]);ge=Object(_["a"])([Object(O["a"])({})],ge);var ye=ge,be=ye,we=Object(c["a"])(be,fe,me,!1,null,null,null),ke=we.exports,xe=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"login_container"},[r("div",{staticClass:"login_box"},[r("h3",{staticClass:"title"},[e._v("管理员登陆")]),r("form",{staticClass:"login_form",attrs:{action:"post",model:e.loginForm},on:{submit:function(t){return t.preventDefault(),e.login(t)}}},[r("label",{staticClass:"sr-only",attrs:{for:"name"}},[e._v("用户名")]),r("input",{directives:[{name:"model",rawName:"v-model",value:e.loginForm.username,expression:"loginForm.username"}],attrs:{type:"text",placeholder:"用户名",id:"name"},domProps:{value:e.loginForm.username},on:{input:function(t){t.target.composing||e.$set(e.loginForm,"username",t.target.value)}}}),r("br"),r("label",{staticClass:"sr-only",attrs:{for:"password"}},[e._v("密码")]),r("input",{directives:[{name:"model",rawName:"v-model",value:e.loginForm.password,expression:"loginForm.password"}],attrs:{type:"text",placeholder:"密码",id:"password"},domProps:{value:e.loginForm.password},on:{input:function(t){t.target.composing||e.$set(e.loginForm,"password",t.target.value)}}}),r("br"),e._m(0)])])])},_e=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"check"},[r("button",{attrs:{id:"submit",type:"submit"}},[e._v("登录")])])}],Oe=function(e){function t(){var e;return Object(y["a"])(this,t),e=Object(w["a"])(this,Object(k["a"])(t).apply(this,arguments)),e.loginForm={username:"",password:""},e}return Object(x["a"])(t,e),Object(b["a"])(t,[{key:"login",value:function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(""!==this.loginForm.username&&""!==this.loginForm.password){e.next=3;break}return this.$message.warning("用户名或密码不能为空"),e.abrupt("return");case 3:return e.prev=3,e.next=6,this.$http.post("auth/login",this.loginForm);case 6:t=e.sent,t.data.access_token&&(window.localStorage.setItem("token","Bearer "+t.data.access_token),t.data.admin?(this.$message.success("登陆成功"),window.localStorage.setItem("admin","true"),this.$router.push("/admin/videos/list")):this.$message.error("系统出错,暂时无法处理请求")),e.next=14;break;case 10:e.prev=10,e.t0=e["catch"](3),this.$message.error("登陆失败"),this.loginForm.password="";case 14:case"end":return e.stop()}}),e,this,[[3,10]])})));function t(){return e.apply(this,arguments)}return t}()}]),t}(O["c"]);Oe=Object(_["a"])([Object(O["a"])({})],Oe);var je=Oe,$e=je,Ce=(r("1dbb"),Object(c["a"])($e,xe,_e,!1,null,"5043aca2",null)),Me=Ce.exports,qe=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[e.option.column?r("avue-crud",{attrs:{page:e.page,data:e.data.data,option:e.option},on:{"update:page":function(t){e.page=t},"on-load":e.changePage,"sort-change":e.changeSort,"search-change":e.search,"row-save":e.create,"row-update":e.update,"row-del":e.remove},scopedSlots:e._u([{key:"menu",fn:function(t){return"posts"==e.resource?[r("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-edit",circle:""},on:{click:function(r){return e.edit(t)}}})]:void 0}}],null,!0)}):e._e()],1)},Re=[],Se=(r("99af"),r("7db0"),function(e){function t(){var e;return Object(y["a"])(this,t),e=Object(w["a"])(this,Object(k["a"])(t).apply(this,arguments)),e.data={},e.page={total:0,pageSize:2,pageSizes:[2,5,10]},e.query={limit:5,page:1,sort:null,where:null,admin:!0},e.option={},e}return Object(x["a"])(t,e),Object(b["a"])(t,[{key:"created",value:function(){this.fetch(),this.fetchOption()}},{key:"fetchOption",value:function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$http.get("".concat(this.resource,"/option"));case 2:t=e.sent,this.option=t.data;case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"fetch",value:function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$http.get("".concat(this.resource),{params:{page:this.query.page,limit:this.query.limit,sort:this.query.sort,where:this.query.where,admin:this.query.admin}});case 2:t=e.sent,this.data=t.data,this.page.total=t.data.total;case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"changePage",value:function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(t){var r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:r=t.pageSize,a=t.currentPage,this.query.page=a,this.query.limit=r,this.fetch();case 4:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"changeSort",value:function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(t){var r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:r=t.prop,a=t.order,this.query.sort=a?"ascending"===a?r:"-"+r:null,this.fetch();case 3:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"search",value:function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(t,r){var a,n,i=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:for(n in a=function(e){var r=i.option.column.find((function(t){return t.prop===e}));r.regex&&(t[e]={$regex:t[e]})},t)a(n);this.query.where=t,this.fetch(),r();case 5:case"end":return e.stop()}}),e,this)})));function t(t,r){return e.apply(this,arguments)}return t}()},{key:"create",value:function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(t,r,a){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$http.post("".concat(this.resource,"/create"),t);case 2:this.$message.success("创建成功"),this.fetch(),r();case 5:case"end":return e.stop()}}),e,this)})));function t(t,r,a){return e.apply(this,arguments)}return t}()},{key:"update",value:function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(t,r,a,n){var i,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i=JSON.parse(JSON.stringify(t)),delete i.$index,e.next=4,this.$http.put("".concat(this.resource,"/update/").concat(t._id),i);case 4:s=e.sent,s.data.success?this.$message.success("修改成功"):this.$message.error("修改失败"),this.fetch(),a();case 8:case"end":return e.stop()}}),e,this)})));function t(t,r,a,n){return e.apply(this,arguments)}return t}()},{key:"remove",value:function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.$confirm("你确定吗?");case 3:e.next=8;break;case 5:return e.prev=5,e.t0=e["catch"](0),e.abrupt("return");case 8:return e.next=10,this.$http.delete("".concat(this.resource,"/delete/").concat(t._id));case 10:r=e.sent,r.data.success?this.$message.success("删除成功"):this.$message.warning("删除失败"),this.fetch();case 13:case"end":return e.stop()}}),e,this,[[0,5]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"edit",value:function(e){var t=e.row;this.$router.push({path:"/post/edit/".concat(t._id)})}}]),t}(O["c"]));Object(_["a"])([Object(O["b"])(String)],Se.prototype,"resource",void 0),Se=Object(_["a"])([Object(O["a"])({})],Se);var Fe=Se,Ee=Fe,Pe=Object(c["a"])(Ee,qe,Re,!1,null,null,null),Ve=Pe.exports;i.a.use(p.a);var De=[{path:"/",component:q,children:[{name:"List",path:"/",component:N},{name:"Video",path:"/play/:id",component:U,props:!0},{name:"History",path:"user/:resource",component:ve,props:!0},{name:"Favorite",path:"user/:resource",component:ve,props:!0},{name:"File",path:"/file",component:ee},{name:"Archive",path:"/archive",component:oe}]},{path:"/admin",name:"Admin",component:ke,children:[{name:"Default",path:"/admin",redirect:"/admin/login"},{name:"Videos-Crud",path:"/admin/:resource/list",component:Ve,props:!0}]},{name:"Login",path:"/admin/login",component:Me}],Ae=new p.a({mode:"history",routes:De});Ae.beforeEach((function(e,t,r){if("/history"===e.path||"/favorite"===e.path){var a=window.sessionStorage.getItem("token");if(!a)return r("/");r()}else r()}));var Ne=Ae,Te=r("cebe"),Ie=r.n(Te);r("aede"),r("4d63"),r("ac1f"),r("5319");function ze(e){for(var t=Math.round((Date.now()-e)/1e3),r=["年","个月","星期","天","小时","分钟","秒"],a=[31536e3,2592e3,604800,86400,3600,60,1],n=0;n<a.length;n++){var i=Math.floor(t/a[n]);if(0!=i)return i+r[n]+"前"}}Date.prototype.Format=function(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};for(var r in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),t)new RegExp("("+r+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?t[r]:("00"+t[r]).substr((""+t[r]).length)));return e};var Le=function(e){return e.length>20?e.substr(0,20)+"...":e},Be=function(e){return ze(new Date(e).getTime())},Je=function(e){return new Date(e).Format("yyyy-MM-dd")},He=r("80d3"),Ye=r.n(He);r("3f5c");i.a.use(Ye.a);var Ue=r("a2c9"),Ge=r.n(Ue);r("bf40");i.a.use(Ge.a);var Ke={theme:{dark:!0}},Qe=new Ge.a(Ke);i.a.config.productionTip=!1,Ie.a.defaults.baseURL="https://video.alfalfa.website",Ie.a.interceptors.request.use((function(e){return localStorage.token&&(e.headers.Authorization="Bearer "+localStorage.token),e}),(function(e){return Promise.reject(e)})),i.a.prototype.$httpajax=Ie.a,i.a.prototype.$http=Ie.a,Object.keys(a).forEach((function(e){i.a.filter(e,a[e])})),new i.a({router:Ne,vuetify:Qe,render:function(e){return e(h)}}).$mount("#app")},"95de":function(e,t,r){"use strict";var a=r("a88f"),n=r.n(a);n.a},"9c52":function(e,t,r){},a2c9:function(e,t){e.exports=Vuetify},a6c4:function(e,t,r){},a88f:function(e,t,r){},aede:function(e,t,r){},afa9:function(e,t,r){"use strict";var a=r("1de9"),n=r.n(a);n.a},bdeb:function(e,t,r){"use strict";var a=r("8a22"),n=r.n(a);n.a},cebe:function(e,t){e.exports=axios},e572:function(e,t,r){"use strict";var a=r("2c81"),n=r.n(a);n.a},fc11:function(e,t,r){}});
//# sourceMappingURL=app.5c7e7538.js.map